import re
import pandas as pd
import json

pd.set_option('display.max_rows', None)
pd.set_option('display.max_columns', None)
pd.set_option('display.width', None)
pd.set_option('display.max_colwidth', None)


def return_search(lst):
    result = []
    for operation in lst:
        if operation['Категория'] == 'Переводы':
            for value in operation.values():
                search = re.findall(r'^\w+\s\D\.$', str(value))
                if search:
                    result.append(operation)
    return json.dumps(result)


return_search([{'MCC': 'nan',
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '10.01.2018 12:43:34',
  'Дата платежа': '10.01.2018',
  'Категория': 'nan',
  'Кэшбэк': 'nan',
  'Номер карты': '*5441',
  'Округление на инвесткопилку': 0,
  'Описание': 'Перевод с карты',
  'Статус': 'FAILED',
  'Сумма операции': -30068.0,
  'Сумма операции с округлением': 30068.0,
  'Сумма платежа': -30068.0},
 {'MCC': 'nan',
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '10.01.2018 12:42:44',
  'Дата платежа': '10.01.2018',
  'Категория': 'nan',
  'Кэшбэк': 'nan',
  'Номер карты': '*5441',
  'Округление на инвесткопилку': 0,
  'Описание': 'Перевод с карты',
  'Статус': 'FAILED',
  'Сумма операции': -40068.0,
  'Сумма операции с округлением': 40068.0,
  'Сумма платежа': -40068.0},
 {'MCC': 'nan',
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '10.01.2018 12:41:24',
  'Дата платежа': '10.01.2018',
  'Категория': 'nan',
  'Кэшбэк': 'nan',
  'Номер карты': '*5441',
  'Округление на инвесткопилку': 0,
  'Описание': 'Перевод с карты',
  'Статус': 'FAILED',
  'Сумма операции': -87068.0,
  'Сумма операции с округлением': 87068.0,
  'Сумма платежа': -87068.0},
 {'MCC': 5411.0,
  'Бонусы (включая кэшбэк)': 7,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '08.01.2018 21:29:43',
  'Дата платежа': '10.01.2018',
  'Категория': 'Супермаркеты',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Дикси',
  'Статус': 'OK',
  'Сумма операции': -364.49,
  'Сумма операции с округлением': 364.49,
  'Сумма платежа': -364.49},
 {'MCC': 4814.0,
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '08.01.2018 14:21:23',
  'Дата платежа': '10.01.2018',
  'Категория': 'Связь',
  'Кэшбэк': 'nan',
  'Номер карты': '*4556',
  'Округление на инвесткопилку': 0,
  'Описание': 'МТС',
  'Статус': 'OK',
  'Сумма операции': -250.0,
  'Сумма операции с округлением': 250.0,
  'Сумма платежа': -250.0},
 {'MCC': 5311.0,
  'Бонусы (включая кэшбэк)': 20,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '08.01.2018 13:38:08',
  'Дата платежа': '10.01.2018',
  'Категория': 'Различные товары',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Torgovyy Dom Mayak',
  'Статус': 'OK',
  'Сумма операции': -1004.9,
  'Сумма операции с округлением': 1004.9,
  'Сумма платежа': -1004.9},
 {'MCC': 5411.0,
  'Бонусы (включая кэшбэк)': 1,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '05.01.2018 15:28:22',
  'Дата платежа': '07.01.2018',
  'Категория': 'Супермаркеты',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Пятёрочка',
  'Статус': 'OK',
  'Сумма операции': -79.6,
  'Сумма операции с округлением': 79.6,
  'Сумма платежа': -79.6},
 {'MCC': 5992.0,
  'Бонусы (включая кэшбэк)': 2,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '05.01.2018 14:58:38',
  'Дата платежа': '07.01.2018',
  'Категория': 'Цветы',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Magazin  Prestizh',
  'Статус': 'OK',
  'Сумма операции': -120.0,
  'Сумма операции с округлением': 120.0,
  'Сумма платежа': -120.0},
 {'MCC': 5541.0,
  'Бонусы (включая кэшбэк)': 20,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '04.01.2018 15:00:41',
  'Дата платежа': '05.01.2018',
  'Категория': 'Топливо',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Pskov AZS 12 K2',
  'Статус': 'OK',
  'Сумма операции': -1025.0,
  'Сумма операции с округлением': 1025.0,
  'Сумма платежа': -1025.0},
 {'MCC': 5411.0,
  'Бонусы (включая кэшбэк)': 21,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '04.01.2018 14:05:08',
  'Дата платежа': '06.01.2018',
  'Категория': 'Супермаркеты',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Пятёрочка',
  'Статус': 'OK',
  'Сумма операции': -1065.9,
  'Сумма операции с округлением': 1065.9,
  'Сумма платежа': -1065.9},
 {'MCC': 5499.0,
  'Бонусы (включая кэшбэк)': 1,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '03.01.2018 15:03:35',
  'Дата платежа': '04.01.2018',
  'Категория': 'Супермаркеты',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'Magazin 25',
  'Статус': 'OK',
  'Сумма операции': -73.06,
  'Сумма операции с округлением': 73.06,
  'Сумма платежа': -73.06},
 {'MCC': 5977.0,
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '03.01.2018 14:55:21',
  'Дата платежа': '05.01.2018',
  'Категория': 'Красота',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'OOO Balid',
  'Статус': 'OK',
  'Сумма операции': -21.0,
  'Сумма операции с округлением': 21.0,
  'Сумма платежа': -21.0},
 {'MCC': 5977.0,
  'Бонусы (включая кэшбэк)': 6,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '01.01.2018 20:27:51',
  'Дата платежа': '04.01.2018',
  'Категория': 'Красота',
  'Кэшбэк': 'nan',
  'Номер карты': '*7197',
  'Округление на инвесткопилку': 0,
  'Описание': 'OOO Balid',
  'Статус': 'OK',
  'Сумма операции': -316.0,
  'Сумма операции с округлением': 316.0,
  'Сумма платежа': -316.0},
 {'MCC': 'nan',
  'Бонусы (включая кэшбэк)': 0,
  'Валюта операции': 'RUB',
  'Валюта платежа': 'RUB',
  'Дата операции': '01.01.2018 12:49:53',
  'Дата платежа': '01.01.2018',
  'Категория': 'Переводы',
  'Кэшбэк': 'nan',
  'Номер карты': 'nan',
  'Округление на инвесткопилку': 0,
  'Описание': 'Валерий А.',
  'Статус': 'OK',
  'Сумма операции': -3000.0,
  'Сумма операции с округлением': 3000.0,
  'Сумма платежа': -3000.0}])
